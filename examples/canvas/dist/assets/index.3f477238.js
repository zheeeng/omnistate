var N=(t,e,r)=>{if(!e.has(t))throw TypeError("Cannot "+r)};var l=(t,e,r)=>(N(t,e,"read from private field"),r?r.call(t):e.get(t)),v=(t,e,r)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,r)},w=(t,e,r,o)=>(N(t,e,"write to private field"),o?o.call(t,r):e.set(t,r),r);import{R as s,j as R,a as K}from"./vendor.fcf28522.js";const U=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const a of c.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function r(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerpolicy&&(c.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?c.credentials="include":n.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(n){if(n.ep)return;n.ep=!0;const c=r(n);fetch(n.href,c)}};U();var h,y,g,S,b;class V{constructor(e){v(this,h,void 0);v(this,y,200);v(this,g,200);v(this,S,100);v(this,b,100);const r=e.getContext("2d");if(!r)throw new Error("Not support canvas context!");e.width=l(this,y),e.height=l(this,g),w(this,h,r)}get x(){return l(this,S)}set x(e){w(this,S,(e+l(this,y))%l(this,y))}get y(){return l(this,b)}set y(e){w(this,b,e%l(this,g))}drawCircle(){l(this,h).clearRect(0,0,l(this,y),l(this,g)),l(this,h).beginPath(),l(this,h).arc(l(this,S),l(this,b),10,0,2*Math.PI),l(this,h).fillStyle="red",l(this,h).fill()}}h=new WeakMap,y=new WeakMap,g=new WeakMap,S=new WeakMap,b=new WeakMap;var z=Object.defineProperty,E=Object.getOwnPropertySymbols,I=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable,q=(t,e,r)=>e in t?z(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,G=(t,e)=>{for(var r in e||(e={}))I.call(e,r)&&q(t,r,e[r]);if(E)for(var r of E(e))$.call(e,r)&&q(t,r,e[r]);return t},Y=(t,e)=>{var r={};for(var o in t)I.call(t,o)&&e.indexOf(o)<0&&(r[o]=t[o]);if(t!=null&&E)for(var o of E(t))e.indexOf(o)<0&&$.call(t,o)&&(r[o]=t[o]);return r};function B(t){return t.charAt(0).toUpperCase()+t.slice(1)}function J(t,e=0){const n=t.replace(/^\n/,"").replace(/\n$/,"").split(`
`),c=Math.min(...n.filter(u=>u!=="").map(u=>u.search(/[^ ]|$/))),a=" ".repeat(Math.max(c,0)),p=" ".repeat(Math.max(e,0));return n.map(u=>u===""?u:u.replace(a,p)).join(`
`)}function T(t){const e=(()=>{const n={};return globalThis.Proxy&&t?new Proxy(n,{get:(c,a)=>{if(Object.prototype.hasOwnProperty.call(c,a))return c[a];throw new Error(J(`

                            ------------------------------------------------------------
                            The property "${a}" does not exist on "${t}".
                                Read data which "${t}" provided fails.
                                Please make sure:
                                1. Your have rightly placed the provider of "${t}". See https://reactjs.org/docs/context.html#contextprovider for detail.".
                                2. Call the Omnistate hoo   ks after running React Application.
                            ------------------------------------------------------------

                            `))}}):n})();return{store:e,fromEntries:n=>{for(const[c,a]of n)e[c]=a},clear:()=>{for(const n of Object.keys(e))delete e[n]}}}var Q=!1;function X(t){const e=Q?B(t.name.replace(/^use/,""))||"[anonymous]":void 0,r=T(e),o=T(e),n=s.memo(function(p){return s.useEffect(()=>o.fromEntries(Object.entries(p)),[p]),s.useEffect(()=>()=>{r.clear(),o.clear()},[]),null});return[a=>{var p=a,{children:u}=p,C=Y(p,["children"]);const k=t(C),[L]=s.useState(()=>{const i=Object.entries(k).map(([d,m])=>{const x=s.createContext(m),P=()=>s.useContext(x);return{hookName:`use${B(d)}`,key:d,context:x,useContext:P}});return r.fromEntries(i.map(({hookName:d,useContext:m})=>[d,m])),i});return L.reduce((i,d)=>s.createElement(d.context.Provider,{value:k[d.key]},i),s.createElement(s.Fragment,null,u,s.createElement(n,G({},k))))},r.store,o.store]}var Z=t=>{const e={};return t.forEach(([r,o,n,c])=>{Object.defineProperty(e,r,n?{get:n,set:c}:{value:o})}),e},F=new WeakMap,ee=t=>{const e=Object.create(t);return F.set(e,t),e},j=t=>{var e;const r=(e=F.get(t))!=null?e:t;return Object.getOwnPropertyNames(r).reduce((o,n)=>(o[n]=r[n],o),{})};function te(t,{accessors:e,methods:r}){const[,o]=s.useReducer(i=>i+1,0),[n]=s.useState(t),[c]=s.useState(e),[a]=s.useState(r),p=c.map(i=>{const[d,m]=s.useState(()=>n[i]),x=s.useCallback(()=>n[i],[i]),P=s.useCallback(_=>{n[i]=_,m(n[i])},[i]);return[i,d,x,P]}),u=a.map(i=>{const d=s.useCallback((...m)=>{const x=n[i](...m);return o(),x},[i]);return[i,d]}),[C]=s.useState(()=>Z([...p,...u])),k=p.map(([,i])=>i);return s.useMemo(()=>ee(C),k)}function re({canvasKit:t}){return{kit:te(t,{accessors:["x","y"],methods:["drawCircle"]})}}const[A,H,O]=X(re),f=R.exports.jsx,M=R.exports.jsxs,ne=R.exports.Fragment;function W(){const t=H.useKit(),e=s.useCallback(()=>{t.x+=Math.random()*5,t.y+=Math.random()*5,console.log(j(t)),t.drawCircle()},[t]);return console.log("render Btn, canvasKit:",console.log(j(t))),f("button",{className:"btn",onClick:e,children:"Draw by React"})}function oe(){const t=H.useKit();return console.log("render App, canvasKit:",console.log(j(t))),M(ne,{children:[f("h1",{className:"title",children:"React"}),M("p",{className:"text",children:["x: ",t.x]}),M("p",{className:"text",children:["y: ",t.y]}),f(W,{}),f("p",{className:"tip",children:"Button calls the hooks which Omnistate provided, DOM are driven by React reactively."})]})}const D=document.getElementById("canvas");if(D instanceof HTMLCanvasElement){const t=new V(D);{const e=document.querySelector("#vanilla"),r=e==null?void 0:e.querySelector("#text1"),o=e==null?void 0:e.querySelector("#text2"),n=e==null?void 0:e.querySelector("#btn");if(r&&o&&n){const c=()=>{r.textContent=`x: ${t.x}`,o.textContent=`y: ${t.y}`};n.addEventListener("click",()=>{t.x+=Math.random()*5,t.y+=Math.random()*5,console.log(t),t.drawCircle(),c()}),c()}}{const e=document.querySelector("#react");e&&K.render(f(s.StrictMode,{children:f(A,{canvasKit:t,children:f(oe,{})})}),e)}{const e=document.querySelector("#bound"),r=e==null?void 0:e.querySelector("#text1"),o=e==null?void 0:e.querySelector("#text2"),n=e==null?void 0:e.querySelector("#btn"),c=e==null?void 0:e.querySelector("#react-btn-slot");if(r&&o&&n){const a=()=>{r.textContent=`x: ${t.x}`,o.textContent=`y: ${t.y}`};n.addEventListener("click",()=>{O.kit.x+=Math.random()*5,O.kit.y+=Math.random()*5,console.log(O.kit),O.kit.drawCircle(),a()}),a()}c&&K.render(f(s.StrictMode,{children:f(A,{canvasKit:t,children:f(W,{})})}),c)}}
